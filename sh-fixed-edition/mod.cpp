#include "pch.h"
#include "MemAccess.h"
#include <iostream>
#include <fstream>
#include <windows.h>
#include <fcntl.h>
#include <io.h>


// Unfrozen Title Screen
/// Makes the title screen animation continuous instead of freezing after pressing START Button/ENTER Key.
void TitleScr(bool enable)
{
    if (enable)
    {
        char TitleScr1[] = {
            0xA1, 0x30, 0x49, 0xAA, 0x00, 0x83, 0xF8, 0xFE, 0xB9, 0x03, 0x00, 0x00, 0x00, 0x89, 0x4F, 0x2C,
            0x5E, 0x7C, 0x0B, 0x83, 0xF8, 0x63, 0x7D, 0x06, 0x83, 0xF8, 0xFE, 0x75, 0x01, 0x41, 0x8B, 0x87,
            0x84, 0x00, 0x00, 0x00, 0x40, 0x89, 0x4F, 0x40, 0xC7, 0x47, 0x48, 0x01, 0x00, 0x00, 0x00, 0x89,
            0x4F, 0x2C, 0x89, 0x87, 0x84, 0x00, 0x00, 0x00, 0x5B, 0x59, 0xC3, 0x83, 0xF8, 0x03, 0x75, 0x0A,
            0xD9, 0x41, 0x34, 0xD9, 0xE8, 0xDE, 0xC1, 0xD9, 0x59, 0x34, 0x83, 0xE8, 0x05, 0x0F, 0x84, 0x20,
            0xFE, 0xFF, 0xFF, 0xE9, 0xEF, 0xFD, 0xFF, 0xFF
        };
        WriteData((void*)0x4569F1, TitleScr1);

        char TitleScr2[] = {
            0xE9, 0xF4, 0x01, 0x00, 0x00
        };
        WriteData((void*)0x456833, TitleScr2);
    }
}

// Demo Gameplay
/// Enables Demo Mode that is leftover in the Windows port of the game. GameCube and PlayStation ports contain Demo Gameplay by default.
void DemoMode(bool enable)
{
    if (enable)
    {
        char DemoMode[] = {
            0x80, 0xF9, 0x06, 0x0F, 0x4D, 0xCB
        };
        WriteData((void*)0x45698A, DemoMode);
    }
}

// Menu Prompt/Credits Text Size
/// The text on the menu prompts and credits don't resize properly, causing them to be smaller at bigger screen resolutions.
////// !!! WIP !!!

// Knuckles Cut-Off Line
/// Knuckles gets cut-off by the screen fade.
void VoiceTimerRange_TSonic()
{
    WriteData((char*)0x7443C8, (char)0xFF);
}

// Cheese on the Main Menu
/// Cheese doesn't appear in the menu in every port. However, the PC port contains unused animations for his menu idling and lock-in pose.
//////   !!! WIP !!!

// Broken Env Map Lighting
/// Environmental Maps don't get affected by stage lighting, making them still show and not blend in darker lightings.
//////   !!! WIP !!!

// Speed Formation Damage Stun Fix
/// Fixes the Damage Stun on Speed Formation Characters (Sonic/Super, Shadow, Amy, Espio).
/// Courtesy of AkoSiRyan for finding the fix originally!
void SpdDamJmp()
{
    WriteData((char*)0x5CF2DD, (char)0xEB);
}

// Shadow's Black Tornado
///Shadow's tornado effect is single-sided, caused by an incorrect culling materials applied to the model.
void ShTornado()
{
    char ShTornado[] = {
        0x14, 0xE8, 0xE3, 0xCA
    };
    WriteData((void*)0x63FEC7, ShTornado);
}

// Shadow's Chaos Emerald
/// Chaos Emerald from Chaos Inferno has different blendings compared to other ports. Not to mention its model and blending is vastly different from SA2.
enum class TDarkChaosEme {
    Untouched,
    Console,
    SA2
};
void conifg_TDarkChaosEme(TDarkChaosEme selection)
{
    switch (selection)
    {
    case TDarkChaosEme::Untouched:
    default:
        // Do nothing.
        break;
    case TDarkChaosEme::Console:
        WriteData((char*)0x5BDE87, (char)0x05);
        WriteData((char*)0x5BDE90, (char)0x02);
        WriteData((char*)0x5BDE99, (char)0x01);
        WriteData((char*)0x5BDEA5, (char)0x00);
        break;
    case TDarkChaosEme::SA2:
        WriteData((char*)0x5BDE87, (char)0x05);
        WriteData((char*)0x5BDE90, (char)0x06);
        WriteData((char*)0x5BDE99, (char)0x02);
        WriteData((char*)0x5BDEA5, (char)0x01);
        break;
    }
}

// Chaotix Recital's Wrong Spotlight Colors
/// Spotlights for Team Chaotix's Team Blast are seemingly using one color (all purple) instead of three (purple, orange and green).
//////   !!! WIP !!!

// Fade-Out Effects
/// Unlike on consoles, Some effects don't fade-out on PC.
//////   !!! WIP !!!

// Signal Monitor Flickering
/// Flickering animation present in GC/XB ports that is missing on PC.
void SignalFlick()
{
    char SignalFlick1[] = {
        0xA1, 0xE4, 0x77, 0xA7, 0x00, 0x83, 0xEC, 0x10, 0x57, 0x8B, 0xF9, 0x8A, 0x48, 0x20, 0x84, 0xC9,
        0x0F, 0x85, 0xF4, 0x00, 0x00, 0x00, 0x55, 0x8B, 0x68, 0x30, 0x8D, 0x87, 0xBC, 0x00, 0x00, 0x00,
        0x8B, 0x08, 0x8B, 0x50, 0x04, 0x8B, 0x40, 0x08, 0x89, 0x4C, 0x24, 0x08, 0x8B, 0x0D, 0x4C, 0x0A,
        0x8E, 0x00, 0x89, 0x54, 0x24, 0x0C, 0x8D, 0x54, 0x24, 0x08, 0x89, 0x44, 0x24, 0x10, 0x8B, 0x01,
        0x52, 0x50, 0xC7, 0x44, 0x24, 0x1C, 0x00, 0x00, 0x70, 0x41, 0xE8, 0xC1, 0x3E, 0x1C, 0x00, 0x83,
        0xC4, 0x08, 0x85, 0xC0, 0x0F, 0x84, 0xAF, 0x00, 0x00, 0x00, 0x8B, 0x47, 0x2C, 0x8B, 0x40, 0x18,
        0xC1, 0xE8, 0x12, 0x24, 0x07, 0x04, 0x04, 0x78, 0x09, 0x3C, 0x13, 0x7D, 0x05, 0xA2, 0x76, 0xDD,
        0x9D, 0x00, 0x53, 0x8A, 0x1D, 0x76, 0xDD, 0x9D, 0x00, 0x56, 0xBE, 0xB8, 0xD8, 0x9D, 0x00, 0xE8,
        0xEC, 0xFB, 0xF9, 0xFF, 0x0F, 0xBE, 0x87, 0xB8, 0x00, 0x00, 0x00, 0xB9, 0x20, 0x7D, 0xA7, 0x00,
        0x5E, 0x5B, 0x8B, 0x44, 0x81, 0x0C, 0x8B, 0x09, 0x50, 0x51, 0xE8, 0x70, 0x00, 0x00, 0x00, 0xC1,
        0xE5, 0x0B, 0x83, 0xC4, 0x08, 0x81, 0xE5, 0xFF, 0xFF, 0x00, 0x80, 0x79, 0x08, 0x4D, 0x81, 0xCD,
        0x00, 0x00, 0xFF, 0xFF, 0x45, 0x81, 0xE5, 0xFF, 0xFF, 0x00, 0x00, 0xD9, 0x04, 0xAD, 0x08, 0xEE,
        0x9D, 0x00, 0xD8, 0x05, 0x74, 0x9F, 0x78, 0x00, 0xD8, 0x0D, 0x54, 0x60, 0x74, 0x00, 0xE8, 0xCD,
        0x0A, 0x29, 0x00, 0xD1, 0xE8, 0x0F, 0xB6, 0x80, 0x78, 0x6F, 0x48, 0x00, 0xBA, 0x24, 0x7D, 0xA7,
        0x00, 0x8B, 0x44, 0x82, 0x20, 0x8B, 0x12, 0x50, 0x52, 0xE8, 0xF2, 0x68, 0x1E, 0x00, 0x8B, 0x87,
        0xE0, 0x00, 0x00, 0x00, 0x6A, 0x00, 0x68, 0xF0, 0xC0, 0x42, 0x00, 0x50, 0xE8, 0x0F, 0x48, 0x1E,
        0x00, 0xE8, 0xBA, 0x47, 0x1E, 0x00, 0x83, 0xC4, 0x14, 0x5D, 0x5F, 0x83, 0xC4, 0x10, 0xC3, 0xFF,
        0x74, 0x24, 0x08, 0xFF, 0x74, 0x24, 0x08, 0xE8, 0xC4, 0x68, 0x1E, 0x00, 0x8B, 0x04, 0x24, 0x03,
        0x05, 0x7C, 0x18, 0x8E, 0x00, 0x8B, 0x00, 0x85, 0xC0, 0x89, 0x04, 0x24, 0x74, 0x22, 0xA1, 0xE4,
        0x77, 0xA7, 0x00, 0x8B, 0x40, 0x30, 0x83, 0xE0, 0x03, 0x0F, 0xB6, 0x80, 0x78, 0x6F, 0x48, 0x00,
        0x8B, 0x04, 0x85, 0x90, 0x7C, 0xA7, 0x00, 0x89, 0x44, 0x24, 0x04, 0xE8, 0x90, 0x68, 0x1E, 0x00,
        0x83, 0xC4, 0x08, 0xC3, 0xA1, 0xE4, 0x77, 0xA7, 0x00, 0x83, 0xEC, 0x1C, 0x57, 0x8B, 0xF9, 0x8A,
        0x48, 0x20, 0x84, 0xC9, 0x0F, 0x85, 0xD9, 0x01, 0x00, 0x00, 0x81, 0xBF, 0xE8, 0x00, 0x00, 0x00,
        0x00, 0x24, 0x74, 0xC9, 0x0F, 0x84, 0xC9, 0x01, 0x00, 0x00, 0x55, 0x8D, 0xAF, 0xE4, 0x00, 0x00,
        0x00, 0x68, 0x00, 0x40, 0x1C, 0x47, 0x68, 0x00, 0x00, 0x70, 0x41, 0x8B, 0xCD, 0xE8, 0x0E, 0x11,
        0x1A, 0x00, 0x83, 0xC4, 0x08, 0x85, 0xC0, 0x0F, 0x84, 0xA5, 0x01, 0x00, 0x00, 0x56, 0x8D, 0x4C,
        0x24, 0x18, 0x51, 0x6A, 0x0E, 0xE8, 0x26, 0x5C, 0x1C, 0x00, 0x6A, 0x00, 0x6A, 0x0E, 0xE8, 0xCD,
        0x5B, 0x1C, 0x00, 0xD9, 0x87, 0xC0, 0x00, 0x00, 0x00, 0xD8, 0xA7, 0xE8, 0x00, 0x00, 0x00, 0x83,
        0xC4, 0x10, 0xC7, 0x44, 0x24, 0x1C, 0x00, 0x00, 0xC8, 0x41, 0xC7, 0x44, 0x24, 0x20, 0x00, 0x00,
        0x80, 0x3F, 0xD8, 0x0D, 0x04, 0x5C, 0x74, 0x00, 0xC7, 0x44, 0x24, 0x24, 0x00, 0x00, 0x88, 0x41,
        0xD8, 0x2D, 0x74, 0x9F, 0x78, 0x00, 0xD9, 0x54, 0x24, 0x0C, 0xD8, 0x1D, 0x00, 0x62, 0x74, 0x00,
        0xDF, 0xE0, 0xF6, 0xC4, 0x41, 0x75, 0x26, 0x31, 0xF6, 0x46, 0xE8, 0x91, 0x48, 0x1B, 0x00, 0x8B,
        0x54, 0x24, 0x0C, 0x52, 0x8D, 0x44, 0x24, 0x20, 0x50, 0x8D, 0x87, 0xF0, 0x00, 0x00, 0x00, 0x55,
        0xE8, 0x6B, 0x49, 0x1B, 0x00, 0x83, 0xC4, 0x0C, 0xE8, 0x83, 0x4C, 0x1B, 0x00, 0x53, 0xB3, 0x10,
        0xBE, 0xB8, 0xD8, 0x9D, 0x00, 0x88, 0x1D, 0x76, 0xDD, 0x9D, 0x00, 0xE8, 0x40, 0xFA, 0xF9, 0xFF,
        0xA1, 0x1C, 0x7D, 0xA7, 0x00, 0x85, 0xC0, 0x5B, 0x0F, 0x84, 0xF4, 0x00, 0x00, 0x00, 0x8D, 0x4C,
        0x24, 0x10, 0x51, 0x6A, 0x0A, 0xE8, 0x86, 0x5B, 0x1C, 0x00, 0x8D, 0x54, 0x24, 0x1C, 0x52, 0x6A,
        0x0B, 0xE8, 0x7A, 0x5B, 0x1C, 0x00, 0x8D, 0x44, 0x24, 0x1C, 0x50, 0x6A, 0x14, 0xE8, 0x6E, 0x5B,
        0x1C, 0x00, 0x6A, 0x05, 0x6A, 0x0A, 0xE8, 0x15, 0x5B, 0x1C, 0x00, 0x6A, 0x02, 0x6A, 0x0B, 0xE8,
        0x0C, 0x5B, 0x1C, 0x00, 0x6A, 0x01, 0x6A, 0x14, 0xE8, 0x03, 0x5B, 0x1C, 0x00, 0x8B, 0x0D, 0x1C,
        0x7D, 0xA7, 0x00, 0x8B, 0x71, 0x04, 0x6A, 0x00, 0x68, 0x28, 0x2C, 0x75, 0x00, 0x56, 0xE8, 0x5D,
        0x57, 0x1C, 0x00, 0x8B, 0x97, 0xF4, 0x00, 0x00, 0x00, 0x6A, 0x02, 0x52, 0x68, 0xC8, 0x2E, 0x74,
        0x00, 0x56, 0xE8, 0x29, 0x59, 0x1C, 0x00, 0x8B, 0x87, 0xF0, 0x00, 0x00, 0x00, 0x83, 0xC4, 0x4C,
        0x6A, 0x02, 0x50, 0x68, 0xBC, 0x2E, 0x74, 0x00, 0x56, 0xE8, 0x12, 0x59, 0x1C, 0x00, 0x8B, 0x8F,
        0xF8, 0x00, 0x00, 0x00, 0x6A, 0x02, 0x51, 0x68, 0xD4, 0x2E, 0x74, 0x00, 0x56, 0xE8, 0xFE, 0x58,
        0x1C, 0x00, 0x6A, 0x02, 0x55, 0x56, 0xE8, 0x15, 0x57, 0x1C, 0x00, 0x8B, 0x0D, 0x28, 0x7D, 0xA7,
        0x00, 0x83, 0xC4, 0x2C, 0x85, 0xC9, 0x74, 0x18, 0x0F, 0xBE, 0x87, 0xB8, 0x00, 0x00, 0x00, 0x83,
        0xF8, 0x03, 0x77, 0x0C, 0x8D, 0x04, 0x85, 0xF4, 0xD1, 0x8D, 0x00, 0x8B, 0x10, 0x89, 0x51, 0x04,
        0xA1, 0x1C, 0x7D, 0xA7, 0x00, 0x50, 0xE8, 0xB5, 0x45, 0x1E, 0x00, 0x8B, 0x4C, 0x24, 0x10, 0x51,
        0x6A, 0x14, 0xE8, 0x69, 0x5A, 0x1C, 0x00, 0x8B, 0x54, 0x24, 0x1C, 0x52, 0x6A, 0x0A, 0xE8, 0x5D,
        0x5A, 0x1C, 0x00, 0x8B, 0x44, 0x24, 0x28, 0x50, 0x6A, 0x0B, 0xE8, 0x51, 0x5A, 0x1C, 0x00, 0x83,
        0xC4, 0x1C, 0x8B, 0x4C, 0x24, 0x18, 0x51, 0x6A, 0x0E, 0xE8, 0x42, 0x5A, 0x1C, 0x00, 0x83, 0xC4,
        0x08, 0x5E, 0x5D, 0x5F, 0x83, 0xC4, 0x1C, 0xC3, 0x00, 0x02, 0x01, 0x02, 0xCC, 0xCC, 0xCC, 0xCC
    };
    WriteData((void*)0x486C30, SignalFlick1);

    char SignalFlick2[] = {
        0xE8, 0xAB, 0x1E, 0x02, 0x00
    };
    WriteData((void*)0x464E8F, SignalFlick2);

    char SignalFlick3[] = {
        0xE8, 0xAC, 0x38, 0x01, 0x00
    };
    WriteData((void*)0x47348E, SignalFlick3);

    char SignalFlick4[] = {
        0xE8, 0x61, 0xD9, 0x00, 0x00
    };
    WriteData((void*)0x4793D9, SignalFlick4);

    char SignalFlick5[] = {
        0x84, 0x6D, 0x48, 0x00
    };
    WriteData((void*)0x752C0C, SignalFlick5);
}

// Leadership Crown
/// Leadership Crown Texture is missing from the 2P Bobsled Race HUD.  (?, this exists in vanilla.. i dont understand wheres the need for this lol)
void BobCrown()
{
    char BobCrown[] = {
        0x31, 0xD2, 0x89, 0x15, 0x04, 0x4C, 0xAA, 0x00,
        0x89, 0x15, 0x20, 0x4C, 0xAA, 0x00, 0xD9, 0x1D,
        0x48, 0x4C, 0xAA, 0x00, 0xD9, 0x05, 0x74, 0x9F,
        0x78, 0x00, 0xD9, 0x15, 0x3C, 0x4C, 0xAA, 0x00,
        0xD9, 0x15, 0x58, 0x4C, 0xAA, 0x00, 0xD9, 0xC9,
        0xD9, 0x1D, 0x4C, 0x4C, 0xAA, 0x00, 0x89, 0x15,
        0x08, 0x4C, 0xAA, 0x00, 0xD9, 0x15, 0x24, 0x4C,
        0xAA, 0x00, 0x89, 0x15, 0x40, 0x4C, 0xAA, 0x00,
        0xD9, 0x15, 0x5C, 0x4C, 0xAA, 0x00, 0xA3, 0x00,
        0x4C, 0xAA, 0x00, 0xD9, 0x15, 0xFC, 0x4B, 0xAA,
        0x00, 0xA3, 0x1C, 0x4C, 0xAA, 0x00, 0xD9, 0x15,
        0x18, 0x4C, 0xAA, 0x00, 0xA3, 0x38, 0x4C, 0xAA,
        0x00, 0xD9, 0x15, 0x34, 0x4C, 0xAA, 0x00, 0xA3,
        0x54, 0x4C, 0xAA, 0x00, 0xD9, 0x1D, 0x50, 0x4C,
        0xAA, 0x00, 0xE8, 0xB9, 0x59, 0x24, 0x00, 0x83,
        0xC4, 0x18, 0xC3, 0xCC, 0xCC, 0xCC, 0xCC, 0xCC
    };
    WriteData((void*)0x406FE0, BobCrown);
}

// Sun Lens Flare Size
/// Similar to the text on menu prompts and credits, the Lens Flare doesn't resize properly, causing the object to be smaller at bigger screen resolutions.
//////   !!! WIP !!!

// Stage Speed Cap
/// Missing feature on PC, causing characters to go faster on loops.
//////   !!! WIP !!!

// TXC (Texture Pattern Animation)
/// Makes use of texture animation (similar to PS2 port) rather than indirect shaders.
void IndirectOFF(bool enabled)
{
    if (enabled)
    {
        WriteData((char*)0x749493, (char)0x78);
        WriteData((char*)0x76E6FA, (char)0x78);
        WriteData((char*)0x773227, (char)0x78);

        //Laser Beam Indirect Effects
        WriteData((char*)0x71A800, (char)0x40);
        WriteData((char*)0x71A950, (char)0x40);
        WriteData((char*)0x71AAA0, (char)0x40);
        WriteData((char*)0x71AB79, (char)0x40);
    }
    else
    {
        //Laser Beam Indirect Effects
        WriteData((char*)0x71A800, (char)0x50);
        WriteData((char*)0x71A950, (char)0x50);
        WriteData((char*)0x71AAA0, (char)0x50);
        WriteData((char*)0x71AB79, (char)0x50);
    }
}

// Grand Metropolis Energy Pipes
/// The game does not scan for the high quality object archive for the lava indirect effects.  (?, no idea what this changes actually lol)
void stg03Pipe()
{
    char stg03Pipe1[] = {
        0xB0, 0x3B, 0x57, 0x00, 0xAD, 0x3C, 0x57, 0x00,
        0x62, 0x3B, 0x57, 0x00
    };
    WriteData((void*)0x8DB12C, stg03Pipe1);

    char stg03Pipe2[] = {
        0x6A, 0xFF, 0x68, 0xEB, 0x7E, 0x71, 0x00, 0x64, 0xA1, 0x00, 0x00, 0x00, 0x00, 0x50, 0x64, 0x89,
        0x25, 0x00, 0x00, 0x00, 0x00, 0x51, 0x8B, 0x15, 0x00, 0xEE, 0x9D, 0x00, 0xB9, 0xC0, 0x00, 0x00,
        0x00, 0xE8, 0xF8, 0x46, 0xEB, 0xFF, 0x31, 0xC9, 0x89, 0x04, 0x24, 0x85, 0xC0, 0x89, 0x4C, 0x24,
        0x0C, 0x74, 0x0C, 0x8B, 0x0D, 0xB4, 0x78, 0xA7, 0x00, 0x50, 0xE8, 0x34, 0x01, 0x00, 0x00, 0x8B,
        0x4C, 0x24, 0x04, 0x64, 0x89, 0x0D, 0x00, 0x00, 0x00, 0x00, 0x83, 0xC4, 0x10, 0xC3, 0x83, 0xEC,
        0x20, 0xA1, 0x18, 0x67, 0x8D, 0x00, 0x85, 0xC0, 0x74, 0x02, 0x8B, 0x00, 0x50, 0x68, 0xF4, 0xE6,
        0x76, 0x00, 0x8D, 0x44, 0x24, 0x08, 0x50, 0xE8, 0xA5, 0x67, 0x10, 0x00, 0x68, 0x28, 0x3D, 0xA2,
        0x00, 0xE8, 0x0D, 0x00, 0x00, 0x00, 0x58, 0xE8, 0xBF, 0xFE, 0xFF, 0xFF, 0x83, 0xC4, 0x0C, 0x83,
        0xC4, 0x20, 0xC3, 0xA1, 0xB0, 0xD8, 0x9D, 0x00, 0x8B, 0x80, 0x1C, 0x8C, 0x00, 0x00, 0x83, 0xEC,
        0x20, 0x85, 0xC0, 0x0F, 0x84, 0xAE, 0x00, 0x00, 0x00, 0x53, 0x55, 0x56, 0x57, 0x50, 0xE8, 0x2B,
        0xA8, 0x0D, 0x00, 0x5B, 0xE8, 0xF5, 0xD8, 0x0C, 0x00, 0x8B, 0x15, 0x4C, 0x78, 0xA7, 0x00, 0x8B,
        0x82, 0x50, 0x0A, 0x00, 0x00, 0x8B, 0x6C, 0x24, 0x34, 0x55, 0xE8, 0xDF, 0xB4, 0xEB, 0xFF, 0xBF,
        0xD4, 0x42, 0x8B, 0x00, 0x31, 0xED, 0x83, 0xC5, 0x06, 0x8B, 0x47, 0x04, 0x50, 0x8D, 0x4C, 0x24,
        0x14, 0x68, 0x70, 0xE1, 0x76, 0x00, 0x51, 0xE8, 0x35, 0x67, 0x10, 0x00, 0x8B, 0x15, 0x4C, 0x78,
        0xA7, 0x00, 0x8B, 0xB2, 0x50, 0x0A, 0x00, 0x00, 0x83, 0xC4, 0x0C, 0x8D, 0x4C, 0x24, 0x10, 0x8B,
        0xC6, 0xE8, 0x28, 0xB6, 0xEB, 0xFF, 0x8B, 0xD8, 0x8B, 0x44, 0x24, 0x34, 0x50, 0x8B, 0xC6, 0xE8,
        0x9A, 0xB4, 0xEB, 0xFF, 0x85, 0xC0, 0x74, 0x21, 0x8B, 0x4E, 0x40, 0x56, 0x8B, 0xC3, 0xE8, 0xCB,
        0xB7, 0xEB, 0xFF, 0x85, 0xC0, 0x74, 0x12, 0x89, 0x07, 0x6A, 0x00, 0x68, 0xD0, 0x15, 0x64, 0x00,
        0x50, 0xE8, 0xB8, 0x78, 0x0F, 0x00, 0x83, 0xC4, 0x0C, 0x83, 0xC7, 0x0C, 0x4D, 0x75, 0x9A, 0xA1,
        0xB0, 0xD8, 0x9D, 0x00, 0x8B, 0x88, 0x1C, 0x8C, 0x00, 0x00, 0x51, 0xE8, 0x9E, 0xD8, 0x0C, 0x00,
        0x83, 0xC4, 0x04, 0x5F, 0x5E, 0x5D, 0x5B, 0x83, 0xC4, 0x20, 0xC3, 0x56, 0x57, 0xBE, 0xD4, 0x42,
        0x8B, 0x00, 0x31, 0xFF, 0x83, 0xC7, 0x06, 0x8B, 0x06, 0x85, 0xC0, 0x74, 0x0D, 0x50, 0xE8, 0x9B,
        0x7F, 0x0F, 0x00, 0x31, 0xC0, 0x83, 0xC4, 0x04, 0x89, 0x06, 0x83, 0xC6, 0x0C, 0x4F, 0x75, 0xE7,
        0x5F, 0x5E, 0xC3, 0x64, 0xA1, 0x00, 0x00, 0x00, 0x00, 0x6A, 0xFF, 0x68, 0x7E, 0x8C, 0x71, 0x00,
        0x50, 0x64, 0x89, 0x25, 0x00, 0x00, 0x00, 0x00, 0x53, 0x55, 0x56, 0x57, 0x8B, 0x7C, 0x24, 0x20,
        0x8B, 0xC7, 0xE8, 0x67, 0xF5, 0xEC, 0xFF, 0x31, 0xDB, 0x8D, 0x47, 0x28, 0x89, 0x5C, 0x24, 0x18,
        0xE8, 0x19, 0xA3, 0xEC, 0xFF, 0x8D, 0x77, 0x30, 0x31, 0xC9, 0x41, 0x89, 0x5E, 0x10, 0x66, 0x89,
        0x5E, 0x08, 0x66, 0x89, 0x5E, 0x02, 0x66, 0x89, 0x5E, 0x0A, 0x66, 0x89, 0x4E, 0x04, 0x66, 0x89,
        0x4E, 0x06, 0x89, 0x5E, 0x78, 0xC6, 0x44, 0x24, 0x18, 0x02, 0x8B, 0x0D, 0x60, 0x43, 0x8B, 0x00,
        0xBD, 0x60, 0xD8, 0x77, 0x00, 0x89, 0x28, 0x83, 0xC5, 0x04, 0x8B, 0x47, 0x2C, 0x89, 0x2F, 0x8B,
        0x68, 0x2C, 0x89, 0x4F, 0x04, 0x66, 0xC7, 0x47, 0x1E, 0xC0, 0x00, 0x8A, 0x45, 0x00, 0x38, 0xD8,
        0x7C, 0x04, 0x3C, 0x04, 0x7C, 0x03, 0x88, 0x5D, 0x00, 0x8B, 0xDF, 0xE8, 0x4E, 0x03, 0x00, 0x00,
        0xE8, 0x29, 0x02, 0x00, 0x00, 0x8B, 0x15, 0x4C, 0x0A, 0x8E, 0x00, 0x6A, 0x30, 0xFF, 0x92, 0x34,
        0x01, 0x00, 0x00, 0x8B, 0xD8, 0x83, 0xC4, 0x04, 0x85, 0xDB, 0x74, 0x30, 0x6A, 0x30, 0x68, 0x30,
        0x43, 0x8B, 0x00, 0x53, 0xE8, 0x45, 0x66, 0x10, 0x00, 0x80, 0x4E, 0x09, 0x80, 0x83, 0xC4, 0x0C,
        0x8B, 0xCE, 0x89, 0x5E, 0x10, 0x66, 0xC7, 0x06, 0x04, 0x00, 0x66, 0xC7, 0x46, 0x0A, 0x01, 0x00,
        0xE8, 0x99, 0x37, 0xE9, 0xFF, 0x8B, 0xDE, 0xE8, 0x72, 0x09, 0xEA, 0xFF, 0x8B, 0x47, 0x40, 0x85,
        0xC0, 0x74, 0x22, 0xD9, 0x45, 0x04, 0x8B, 0xDE, 0xD8, 0x48, 0x14, 0xD9, 0x58, 0x14, 0xD9, 0x45,
        0x08, 0xD8, 0x48, 0x18, 0xD9, 0x58, 0x18, 0xD9, 0x45, 0x0C, 0xD8, 0x48, 0x1C, 0xD9, 0x58, 0x1C,
        0xE8, 0x49, 0x09, 0xEA, 0xFF, 0x8B, 0x4C, 0x24, 0x10, 0x8B, 0xC7, 0x5F, 0x5E, 0x5D, 0x64, 0x89,
        0x0D, 0x00, 0x00, 0x00, 0x00, 0x5B, 0x83, 0xC4, 0x0C, 0xC2, 0x04, 0x00, 0xCC, 0xCC
    };
    WriteData((void*)0x573B62, stg03Pipe2);

    char stg03Pipe3[] = {
        0x8B, 0x48, 0x40, 0x8B, 0x91, 0xE0, 0x00, 0x00, 0x00,
        0x39, 0xC2, 0x75, 0x0B, 0x8B, 0x50, 0x3C, 0x89, 0x91,
        0xE0, 0x00, 0x00, 0x00, 0xEB, 0x1B, 0x8D, 0x4A, 0x3C,
        0x56, 0x39, 0x01, 0x74, 0x0C, 0x8B, 0x11, 0x8B, 0x72,
        0x3C, 0x39, 0xC6, 0x8D, 0x4A, 0x3C, 0x75, 0xF4, 0x8B,
        0x48, 0x3C, 0x89, 0x4A, 0x3C, 0x5E, 0x31, 0xD2, 0xC7,
        0x40, 0x3C, 0x00, 0x00, 0x00, 0x00, 0xC3, 0x66, 0x81,
        0x3D, 0x2C, 0x51, 0xAA, 0x00, 0x01, 0x01, 0x72, 0xF4,
        0xE9, 0x38, 0x01, 0x00, 0x00
    };
    WriteData((void*)0x573A60, stg03Pipe3);
}

// Grand Metropolis Pipe Glass
/// Can be seen through walls, caused by an incorrect material flag.  (?, no idea what this changes actually lol)
void stg03PipeGlass()
{
    WriteData((char*)0x574130, (char)0xA4);
}

// Power Plant Transparency issues
/// No use of transparency on the stage (more specifically the green arrows and the Eggman's symbol on the caps)
//////   !!! WIP !!!   (WORK AROUND - i edited the textures so the black parts wouldnt show up)

// Power Plant Steps
/// Steps from the Storage Tank don't have their flicker effect.
//////   !!! WIP !!!

// Rail Grinding Effect
/// Unused in the game completely as well, there are 3 models for a rail grinding effect (EF_GLIND0.DFF, EF_GLIND1.DFF & EF_GLIND2.DFF), similar to Sonic Adventure 2.
//////   !!! WIP !!!

// Frog Forest Root Ball
/// The vertex paint disappears from the model.  (?, no idea what this changes actually lol)
void stg09RootBall()
{
    WriteData((char*)0x4DDC4B, (char)0x60);
}

// Transparent Frog feet
/// The frog's feet in Frog Forest and Lost Jungle are see-through when in deep touch with geometry.
/////   !!! BROKEN, NEEDS BETTER CODE !!!
/*
void stg09FrogFeet()
{
    char stg09FrogFeet1[] = {
        0xC7, 0x05, 0xE4, 0xAB, 0x7B,
        0x00, 0x70, 0x2E, 0x40, 0x00
    };
    WriteData((void*)0x4EE3ED, stg09FrogFeet1);

    char stg09FrogFeet2[] = {
        0x12
    };
    WriteData((void*)0x868A20, stg09FrogFeet2);

    char stg09FrogFeet3[] = {
        0x12
    };
    WriteData((void*)0x868A44, stg09FrogFeet3);
}
*/

// Final Fortress UFO Sign light
/// Fading light arrow animations are missing. (yet does not affect Egg Fleet's UFO!)
void stg14UFO()
{
    char stg14UFO1[] = {
        0x83, 0xEC, 0x08, 0xA1, 0x64, 0x34, 0xAA, 0x00,
        0x56, 0x8B, 0xF1, 0x8B, 0x4E, 0x2C, 0x89, 0x44,
        0x24, 0x04, 0x8B, 0x41, 0x18, 0xF6, 0xC4, 0x04,
        0x75, 0x29, 0x0F, 0xB6, 0x51, 0x2B, 0x42, 0x89,
        0x54, 0x24, 0x08, 0x51, 0xDB, 0x44, 0x24, 0x0C,
        0xD8, 0x0D, 0x28, 0xA0, 0x78, 0x00, 0xD9, 0xC0,
        0xD8, 0xC9, 0xD9, 0x1C, 0x24, 0xDD, 0xD8, 0xE8,
        0x64, 0xA5, 0xF1, 0xFF, 0x83, 0xC4, 0x04, 0x85,
        0xC0, 0x75, 0x76, 0x8B, 0x56, 0x2C, 0xF6, 0x42,
        0x18, 0x04, 0x75, 0x6D, 0xA1, 0xE4, 0x77, 0xA7,
        0x00, 0x8A, 0x48, 0x1F, 0x84, 0xC9, 0x74, 0x08,
        0x8D, 0x46, 0x30, 0x8D, 0x4A, 0x0C, 0xEB, 0x50,
        0x81, 0xC6, 0xB8, 0x00, 0x00, 0x00, 0xD9, 0x06,
        0xD8, 0x05, 0xDC, 0xA0, 0x78, 0x00, 0xD8, 0x54,
        0x24, 0x04, 0xDF, 0xE0, 0xF6, 0xC4, 0x01, 0x75,
        0x04, 0xD8, 0x64, 0x24, 0x04, 0xD9, 0x1E, 0x8B,
        0x0E, 0x57, 0x8B, 0x7E, 0x04, 0x51, 0xE8, 0x85,
        0xE2, 0xFE, 0xFF, 0xA1, 0x48, 0x86, 0xA7, 0x00,
        0x83, 0xC4, 0x04, 0x85, 0xC0, 0x5F, 0x74, 0x09,
        0x50, 0x8B, 0x46, 0x08, 0xE8, 0x21, 0x00, 0x00,
        0x00, 0x81, 0xEE, 0xB8, 0x00, 0x00, 0x00, 0x8B,
        0x56, 0x2C, 0x8D, 0x46, 0x30, 0x8D, 0x4A, 0x0C,
        0x5E, 0x83, 0xC4, 0x08, 0xE9, 0x47, 0x55, 0xF3,
        0xFF, 0x80, 0x4E, 0x08, 0x01, 0x5E, 0x83, 0xC4,
        0x08, 0xC3, 0x6A, 0x00, 0x68, 0x41, 0x3F, 0x52,
        0x00, 0x50, 0xE8, 0x61, 0x78, 0x14, 0x00, 0xFF,
        0x74, 0x24, 0x10, 0xE8, 0x48, 0x03, 0x00, 0x00,
        0x83, 0xC4, 0x0C, 0xC2, 0x04, 0x00
    };
    WriteData((void*)0x523C10, stg14UFO1);

    char stg14UFO2[] = {
        0x8B, 0x40, 0x18, 0x6A, 0x08, 0x50, 0xE8, 0x04,
        0xAD, 0x14, 0x00, 0x83, 0xC4, 0x08, 0xC3
    };
    WriteData((void*)0x523F41, stg14UFO2);
}

// Final Fortress Laser Beam Disabled Backface Culling
/// Backface Culling is rendered as 'front' instead of 'none', making the laser beam a bit incomplete.
//////   !!! WIP !!!   (WORK AROUND - i flipped normals so it would display the head, yet it would be better without any model edits personally, and having both sides showing)

// Final Fortress Laser Beam Effect Display
/// An effect that should appear before and during the laser beam activation, which is not rendered correctly.
//////   !!! WIP !!!

// Boss Defeat Explosion
/// Explosion particles are missing when defeating a boss (Egg Hawk and Egg Albatoross), present on the GameCube port.
//////   !!! WIP !!!

// Missing Logos on Credits
/// ADX and SofDec logos are missing in the game's code. Adding them to the credits text file (or porting the same file from GC/XB to PC) will cause a crash.
//////  !!! WIP !!!

// No Exit Prompt
///! Kell is a God.
void Exit(bool enabled)
{
    if (enabled)
    {
        char Exit[] = {
            0xE9, 0xF1, 0x00, 0x00, 0x00
        };
        WriteData((void*)0x446EFB, Exit);
    }
    else
    {
		// Do nothing.
    }
}

extern "C"
{
    __declspec(dllexport) void InitMod()
    {
        TitleScr(true);
        DemoMode(true);
        VoiceTimerRange_TSonic();
        SpdDamJmp();
        ShTornado();
        conifg_TDarkChaosEme(TDarkChaosEme::Untouched);
        SignalFlick();
		BobCrown();
        IndirectOFF(false);
		stg03Pipe();
		stg03PipeGlass();
		stg09RootBall();
		stg14UFO();
		Exit(true);
    }
}